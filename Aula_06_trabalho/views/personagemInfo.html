{% extends 'base.html' %}
{% block content %}
<div class="container">
    <a href="{{url_for('apinaruto')}}" class="btn btn-dark mb-3"><< Voltar para todos os personagens</a>
    
    <div class="row">
        <div class="col-md-4">
            <div class="character-detail-card">
                {% if personagemInfo.character.images.jpg.image_url %}
                <img src="{{personagemInfo.character.images.jpg.image_url}}" class="img-fluid rounded character-detail-image" alt="{{personagemInfo.character.name}}">
                {% else %}
                <div class="no-image-detail">
                    <span class="no-image-icon">üë§</span>
                    <span class="no-image-text">Sem Imagem</span>
                </div>
                {% endif %}
                
                <!-- Ranking Badge -->
                <div class="ranking-badge-detail">
                    <span class="rank-text" id="ranking-text">S</span>
                </div>
            </div>
        </div>
        
        <div class="col-md-8">
            <div class="character-detail-info">
                <h1 class="character-detail-name">{{personagemInfo.character.name}}</h1>
                <p class="character-detail-kanji">{{personagemInfo.character.name_kanji}}</p>
                
                <!-- Informa√ß√µes Principais -->
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-icon">üé≠</div>
                        <div class="info-content">
                            <h6>Role</h6>
                            <p>{{personagemInfo.role}}</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-icon">üèòÔ∏è</div>
                        <div class="info-content">
                            <h6>Vila</h6>
                            <p id="vila-text">Konoha</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                        <div class="info-content">
                            <h6>Cl√£</h6>
                            <p id="cla-text">Uzumaki</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-icon">üèÜ</div>
                        <div class="info-content">
                            <h6>Rank Ninja</h6>
                            <p id="ninja-rank-text">Hokage</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-icon">‚ö°</div>
                        <div class="info-content">
                            <h6>Ranking</h6>
                            <p id="ranking-display">S+</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-icon">üåç</div>
                        <div class="info-content">
                            <h6>Origem</h6>
                            <p id="origem-text">Konoha</p>
                        </div>
                    </div>
                </div>
                
                <!-- Descri√ß√£o -->
                {% if personagemInfo.character.about %}
                <div class="description-card">
                    <h5>üìñ Sobre o Personagem</h5>
                    <p>{{personagemInfo.character.about}}</p>
                </div>
                {% endif %}
                
                <!-- Dubladores -->
                {% if personagemInfo.voice_actors %}
                <div class="voice-actors-card">
                    <h5>üé§ Dubladores</h5>
                    <div class="voice-actors-grid">
                        {% for va in personagemInfo.voice_actors %}
                        <div class="voice-actor-item">
                            <div class="voice-actor-info">
                                <strong>{{va.language}}:</strong> {{va.person.name}}
                            </div>
                            {% if va.person.images.jpg.image_url %}
                            <img src="{{va.person.images.jpg.image_url}}" class="voice-actor-image" alt="{{va.person.name}}">
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
.character-detail-card {
    position: relative;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 2px solid rgba(255, 107, 53, 0.3);
    border-radius: 20px;
    padding: 20px;
    backdrop-filter: blur(10px);
}

.character-detail-image {
    width: 100%;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.no-image-detail {
    width: 100%;
    height: 300px;
    background: linear-gradient(135deg, rgba(255, 107, 53, 0.1) 0%, rgba(247, 147, 30, 0.1) 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border-radius: 15px;
    color: rgba(255, 255, 255, 0.6);
}

.no-image-icon {
    font-size: 4rem;
    margin-bottom: 15px;
}

.no-image-text {
    font-size: 1.1rem;
}

.ranking-badge-detail {
    position: absolute;
    top: 20px;
    right: 20px;
    background: linear-gradient(45deg, #ff6b35, #f7931e);
    color: white;
    padding: 8px 15px;
    border-radius: 20px;
    font-weight: bold;
    font-size: 1rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.character-detail-info {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 2px solid rgba(255, 107, 53, 0.3);
    border-radius: 20px;
    padding: 30px;
    backdrop-filter: blur(10px);
}

.character-detail-name {
    color: #ff6b35;
    font-family: 'Orbitron', monospace;
    font-weight: 900;
    font-size: 2.5rem;
    margin-bottom: 10px;
    text-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
}

.character-detail-kanji {
    color: #cccccc;
    font-size: 1.2rem;
    margin-bottom: 30px;
    font-style: italic;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.info-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s ease;
}

.info-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(255, 107, 53, 0.2);
    border-color: #ff6b35;
}

.info-icon {
    font-size: 2rem;
    color: #ff6b35;
    min-width: 40px;
}

.info-content h6 {
    color: #ff6b35;
    font-weight: bold;
    margin-bottom: 5px;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.info-content p {
    color: white;
    font-weight: 500;
    margin: 0;
    font-size: 1.1rem;
}

.description-card, .voice-actors-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 20px;
}

.description-card h5, .voice-actors-card h5 {
    color: #ff6b35;
    font-weight: bold;
    margin-bottom: 15px;
    font-family: 'Orbitron', monospace;
}

.description-card p {
    color: #cccccc;
    line-height: 1.6;
    margin: 0;
}

.voice-actors-grid {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.voice-actor-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.voice-actor-info {
    color: white;
    font-weight: 500;
}

.voice-actor-image {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

@media (max-width: 768px) {
    .character-detail-name {
        font-size: 2rem;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .info-card {
        padding: 15px;
    }
    
    .info-icon {
        font-size: 1.5rem;
    }
    
    .ranking-badge-detail {
        top: 15px;
        right: 15px;
        padding: 6px 12px;
        font-size: 0.9rem;
    }
}
</style>

<script>
// Fun√ß√µes para obter informa√ß√µes dos personagens
function getRanking(name) {
    console.log('Procurando ranking para:', name);
    
    const rankings = {
        'Naruto Uzumaki': 'S+',
        'Sasuke Uchiha': 'S+',
        'Kakashi Hatake': 'S',
        'Itachi Uchiha': 'S+',
        'Jiraiya': 'S',
        'Tsunade': 'S',
        'Orochimaru': 'S',
        'Minato Namikaze': 'S+',
        'Hashirama Senju': 'S+',
        'Madara Uchiha': 'S+',
        'Obito Uchiha': 'S',
        'Nagato': 'S',
        'Killer B': 'S',
        'Gaara': 'S',
        'Rock Lee': 'A',
        'Neji Hyuga': 'A',
        'Shikamaru Nara': 'A',
        'Choji Akimichi': 'B',
        'Ino Yamanaka': 'B',
        'Sakura Haruno': 'A',
        'Hinata Hyuga': 'B',
        'Kiba Inuzuka': 'B',
        'Shino Aburame': 'B',
        'Tenten': 'C',
        'Kankuro': 'A',
        'Temari': 'A',
        'Deidara': 'S',
        'Sasori': 'S',
        'Hidan': 'A',
        'Kakuzu': 'A',
        'Kisame Hoshigaki': 'S',
        'Zetsu': 'B',
        'Konan': 'A',
        'Yahiko': 'A',
        'Danzo Shimura': 'S',
        'Shisui Uchiha': 'S',
        'Fugaku Uchiha': 'A',
        'Mikoto Uchiha': 'B',
        'Kushina Uzumaki': 'A',
        'Mito Uzumaki': 'A',
        'Tobirama Senju': 'S',
        'Hiruzen Sarutobi': 'S',
        'Asuma Sarutobi': 'A',
        'Kurenai Yuhi': 'A',
        'Guy': 'S',
        'Yamato': 'A',
        'Anko Mitarashi': 'B',
        'Ibiki Morino': 'A',
        'Genma Shiranui': 'B',
        'Raido Namiashi': 'B',
        'Aoba Yamashiro': 'B',
        'Shizune': 'A',
        'Inoichi Yamanaka': 'A',
        'Choza Akimichi': 'B',
        'Shikaku Nara': 'A',
        'Hiashi Hyuga': 'A',
        'Hizashi Hyuga': 'A'
    };
    
    // Tentar correspond√™ncia exata primeiro
    if (rankings[name]) {
        console.log('Ranking encontrado:', rankings[name]);
        return rankings[name];
    }
    
    // Tentar correspond√™ncia parcial
    for (const key in rankings) {
        if (name.includes(key.split(' ')[0]) || key.includes(name.split(' ')[0])) {
            console.log('Ranking encontrado por correspond√™ncia parcial:', rankings[key]);
            return rankings[key];
        }
    }
    
    console.log('Ranking n√£o encontrado, usando padr√£o: B');
    return 'B';
}

function getVila(name) {
    console.log('Procurando vila para:', name);
    
    const vilas = {
        'Naruto Uzumaki': 'Konoha',
        'Sasuke Uchiha': 'Konoha',
        'Kakashi Hatake': 'Konoha',
        'Itachi Uchiha': 'Konoha',
        'Jiraiya': 'Konoha',
        'Tsunade': 'Konoha',
        'Orochimaru': 'Konoha',
        'Minato Namikaze': 'Konoha',
        'Hashirama Senju': 'Konoha',
        'Madara Uchiha': 'Konoha',
        'Obito Uchiha': 'Konoha',
        'Nagato': 'Ame',
        'Killer B': 'Kumo',
        'Gaara': 'Suna',
        'Rock Lee': 'Konoha',
        'Neji Hyuga': 'Konoha',
        'Shikamaru Nara': 'Konoha',
        'Choji Akimichi': 'Konoha',
        'Ino Yamanaka': 'Konoha',
        'Sakura Haruno': 'Konoha',
        'Hinata Hyuga': 'Konoha',
        'Kiba Inuzuka': 'Konoha',
        'Shino Aburame': 'Konoha',
        'Tenten': 'Konoha',
        'Kankuro': 'Suna',
        'Temari': 'Suna',
        'Deidara': 'Iwa',
        'Sasori': 'Suna',
        'Hidan': 'Yugakure',
        'Kakuzu': 'Taki',
        'Kisame Hoshigaki': 'Kiri',
        'Zetsu': 'Akatsuki',
        'Konan': 'Ame',
        'Yahiko': 'Ame',
        'Danzo Shimura': 'Konoha',
        'Shisui Uchiha': 'Konoha',
        'Fugaku Uchiha': 'Konoha',
        'Mikoto Uchiha': 'Konoha',
        'Kushina Uzumaki': 'Uzushiogakure',
        'Mito Uzumaki': 'Uzushiogakure',
        'Tobirama Senju': 'Konoha',
        'Hiruzen Sarutobi': 'Konoha',
        'Asuma Sarutobi': 'Konoha',
        'Kurenai Yuhi': 'Konoha',
        'Guy': 'Konoha',
        'Yamato': 'Konoha',
        'Anko Mitarashi': 'Konoha',
        'Ibiki Morino': 'Konoha',
        'Genma Shiranui': 'Konoha',
        'Raido Namiashi': 'Konoha',
        'Aoba Yamashiro': 'Konoha',
        'Shizune': 'Konoha',
        'Inoichi Yamanaka': 'Konoha',
        'Choza Akimichi': 'Konoha',
        'Shikaku Nara': 'Konoha',
        'Hiashi Hyuga': 'Konoha',
        'Hizashi Hyuga': 'Konoha'
    };
    
    // Tentar correspond√™ncia exata primeiro
    if (vilas[name]) {
        console.log('Vila encontrada:', vilas[name]);
        return vilas[name];
    }
    
    // Tentar correspond√™ncia parcial
    for (const key in vilas) {
        if (name.includes(key.split(' ')[0]) || key.includes(name.split(' ')[0])) {
            console.log('Vila encontrada por correspond√™ncia parcial:', vilas[key]);
            return vilas[key];
        }
    }
    
    console.log('Vila n√£o encontrada, usando padr√£o: Desconhecida');
    return 'Desconhecida';
}

function getCla(name) {
    console.log('Procurando cl√£ para:', name);
    
    const clas = {
        'Naruto Uzumaki': 'Uzumaki',
        'Sasuke Uchiha': 'Uchiha',
        'Kakashi Hatake': 'Hatake',
        'Itachi Uchiha': 'Uchiha',
        'Jiraiya': 'Jiraiya',
        'Tsunade': 'Senju',
        'Orochimaru': 'Orochimaru',
        'Minato Namikaze': 'Namikaze',
        'Hashirama Senju': 'Senju',
        'Madara Uchiha': 'Uchiha',
        'Obito Uchiha': 'Uchiha',
        'Nagato': 'Uzumaki',
        'Killer B': 'Sabaku',
        'Gaara': 'Sabaku',
        'Rock Lee': 'Lee',
        'Neji Hyuga': 'Hyuga',
        'Shikamaru Nara': 'Nara',
        'Choji Akimichi': 'Akimichi',
        'Ino Yamanaka': 'Yamanaka',
        'Sakura Haruno': 'Haruno',
        'Hinata Hyuga': 'Hyuga',
        'Kiba Inuzuka': 'Inuzuka',
        'Shino Aburame': 'Aburame',
        'Tenten': 'Tenten',
        'Kankuro': 'Sabaku',
        'Temari': 'Sabaku',
        'Deidara': 'Deidara',
        'Sasori': 'Sasori',
        'Hidan': 'Hidan',
        'Kakuzu': 'Kakuzu',
        'Kisame Hoshigaki': 'Hoshigaki',
        'Zetsu': 'Zetsu',
        'Konan': 'Konan',
        'Yahiko': 'Yahiko',
        'Danzo Shimura': 'Shimura',
        'Shisui Uchiha': 'Uchiha',
        'Fugaku Uchiha': 'Uchiha',
        'Mikoto Uchiha': 'Uchiha',
        'Kushina Uzumaki': 'Uzumaki',
        'Mito Uzumaki': 'Uzumaki',
        'Tobirama Senju': 'Senju',
        'Hiruzen Sarutobi': 'Sarutobi',
        'Asuma Sarutobi': 'Sarutobi',
        'Kurenai Yuhi': 'Yuhi',
        'Guy': 'Guy',
        'Yamato': 'Yamato',
        'Anko Mitarashi': 'Mitarashi',
        'Ibiki Morino': 'Morino',
        'Genma Shiranui': 'Shiranui',
        'Raido Namiashi': 'Namiashi',
        'Aoba Yamashiro': 'Yamashiro',
        'Shizune': 'Shizune',
        'Inoichi Yamanaka': 'Yamanaka',
        'Choza Akimichi': 'Akimichi',
        'Shikaku Nara': 'Nara',
        'Hiashi Hyuga': 'Hyuga',
        'Hizashi Hyuga': 'Hyuga'
    };
    
    // Tentar correspond√™ncia exata primeiro
    if (clas[name]) {
        console.log('Cl√£ encontrado:', clas[name]);
        return clas[name];
    }
    
    // Tentar correspond√™ncia parcial
    for (const key in clas) {
        if (name.includes(key.split(' ')[0]) || key.includes(name.split(' ')[0])) {
            console.log('Cl√£ encontrado por correspond√™ncia parcial:', clas[key]);
            return clas[key];
        }
    }
    
    console.log('Cl√£ n√£o encontrado, usando padr√£o: Desconhecido');
    return 'Desconhecido';
}

function getNinjaRank(name) {
    console.log('Procurando rank ninja para:', name);
    
    const ranks = {
        'Naruto Uzumaki': 'Hokage',
        'Sasuke Uchiha': 'Nukenin',
        'Kakashi Hatake': 'Hokage',
        'Itachi Uchiha': 'ANBU',
        'Jiraiya': 'Sannin',
        'Tsunade': 'Hokage',
        'Orochimaru': 'Sannin',
        'Minato Namikaze': 'Hokage',
        'Hashirama Senju': 'Hokage',
        'Madara Uchiha': 'Nukenin',
        'Obito Uchiha': 'Nukenin',
        'Nagato': 'L√≠der Akatsuki',
        'Killer B': 'Jinchuriki',
        'Gaara': 'Kazekage',
        'Rock Lee': 'Jonin',
        'Neji Hyuga': 'Jonin',
        'Shikamaru Nara': 'Jonin',
        'Choji Akimichi': 'Jonin',
        'Ino Yamanaka': 'Jonin',
        'Sakura Haruno': 'Jonin',
        'Hinata Hyuga': 'Chunin',
        'Kiba Inuzuka': 'Jonin',
        'Shino Aburame': 'Jonin',
        'Tenten': 'Chunin',
        'Kankuro': 'Jonin',
        'Temari': 'Jonin',
        'Deidara': 'S-Rank',
        'Sasori': 'S-Rank',
        'Hidan': 'S-Rank',
        'Kakuzu': 'S-Rank',
        'Kisame Hoshigaki': 'S-Rank',
        'Zetsu': 'S-Rank',
        'Konan': 'S-Rank',
        'Yahiko': 'L√≠der',
        'Danzo Shimura': 'ANBU',
        'Shisui Uchiha': 'ANBU',
        'Fugaku Uchiha': 'Jonin',
        'Mikoto Uchiha': 'Chunin',
        'Kushina Uzumaki': 'Jonin',
        'Mito Uzumaki': 'Jinchuriki',
        'Tobirama Senju': 'Hokage',
        'Hiruzen Sarutobi': 'Hokage',
        'Asuma Sarutobi': 'Jonin',
        'Kurenai Yuhi': 'Jonin',
        'Guy': 'Jonin',
        'Yamato': 'ANBU',
        'Anko Mitarashi': 'Jonin',
        'Ibiki Morino': 'ANBU',
        'Genma Shiranui': 'Jonin',
        'Raido Namiashi': 'Jonin',
        'Aoba Yamashiro': 'Jonin',
        'Shizune': 'Jonin',
        'Inoichi Yamanaka': 'ANBU',
        'Choza Akimichi': 'Jonin',
        'Shikaku Nara': 'Jonin',
        'Hiashi Hyuga': 'Jonin',
        'Hizashi Hyuga': 'Jonin'
    };
    
    // Tentar correspond√™ncia exata primeiro
    if (ranks[name]) {
        console.log('Rank ninja encontrado:', ranks[name]);
        return ranks[name];
    }
    
    // Tentar correspond√™ncia parcial
    for (const key in ranks) {
        if (name.includes(key.split(' ')[0]) || key.includes(name.split(' ')[0])) {
            console.log('Rank ninja encontrado por correspond√™ncia parcial:', ranks[key]);
            return ranks[key];
        }
    }
    
    console.log('Rank ninja n√£o encontrado, usando padr√£o: Genin');
    return 'Genin';
}

// Aplicar as informa√ß√µes quando a p√°gina carregar
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM carregado na p√°gina de detalhes...');
    
    const characterName = document.querySelector('.character-detail-name').textContent.trim();
    console.log('Nome do personagem:', characterName);
    
    // Atualizar ranking
    const rankingText = document.getElementById('ranking-text');
    const rankingDisplay = document.getElementById('ranking-display');
    const ranking = getRanking(characterName);
    if (rankingText) {
        rankingText.textContent = ranking;
        console.log('Ranking aplicado no badge:', ranking);
    }
    if (rankingDisplay) {
        rankingDisplay.textContent = ranking;
        console.log('Ranking aplicado no display:', ranking);
    }
    
    // Atualizar vila
    const vilaText = document.getElementById('vila-text');
    const origemText = document.getElementById('origem-text');
    const vila = getVila(characterName);
    if (vilaText) {
        vilaText.textContent = vila;
        console.log('Vila aplicada:', vila);
    }
    if (origemText) {
        origemText.textContent = vila;
        console.log('Origem aplicada:', vila);
    }
    
    // Atualizar cl√£
    const claText = document.getElementById('cla-text');
    const cla = getCla(characterName);
    if (claText) {
        claText.textContent = cla;
        console.log('Cl√£ aplicado:', cla);
    }
    
    // Atualizar rank ninja
    const ninjaRankText = document.getElementById('ninja-rank-text');
    const ninjaRank = getNinjaRank(characterName);
    if (ninjaRankText) {
        ninjaRankText.textContent = ninjaRank;
        console.log('Rank ninja aplicado:', ninjaRank);
    }
});
</script>
{% endblock content %}
